this.tablecloth=function(){var e=false;var t=true;var n=true;this.clickAction=function(e){};var r=false;this.start=function(){var e=document.getElementsByTagName("table");for(var t=0;t<e.length;t++){e[t].onmouseover=function(){r=true};e[t].onmouseout=function(){r=false};rows(e[t])}};this.rows=function(e){var t="";var n=e.getElementsByTagName("tr");for(var r=0;r<n.length;r++){t=t=="odd"?"even":"odd";n[r].className=t;var i=new Array;for(var s=0;s<n[r].childNodes.length;s++){if(n[r].childNodes[s].nodeType==1)i.push(n[r].childNodes[s])}for(var s=0;s<i.length;s++){i[s].row=r;i[s].col=s;if(i[s].innerHTML=="&nbsp;"||i[s].innerHTML=="")i[s].className+=" empty";i[s].css=i[s].className;i[s].onmouseover=function(){over(e,this,this.row,this.col)};i[s].onmouseout=function(){out(e,this,this.row,this.col)};i[s].onmousedown=function(){down(e,this,this.row,this.col)};i[s].onmouseup=function(){up(e,this,this.row,this.col)};i[s].onclick=function(){click(e,this,this.row,this.col)}}}};this.over=function(n,r,i,s){if(!e&&!t)r.className=r.css+" over";if(check1(r,s)){if(e)highlightCol(n,r,s);if(t)highlightRow(n,r,i)}};this.out=function(n,r,i,s){if(!e&&!t)r.className=r.css;unhighlightCol(n,s);unhighlightRow(n,i)};this.down=function(e,t,n,r){t.className=t.css+" down"};this.up=function(e,t,n,r){t.className=t.css+" over"};this.click=function(r,i,s,o){if(check1){if(n){unselect(r);if(e)highlightCol(r,i,o,true);if(t)highlightRow(r,i,s,true);document.onclick=unselectAll}}clickAction(i)};this.highlightCol=function(e,t,n,r){var i=typeof r!="undefined"?"selected":"over";var s=e.getElementsByTagName("tr");for(var o=0;o<s.length;o++){var u=new Array;for(j=0;j<s[o].childNodes.length;j++){if(s[o].childNodes[j].nodeType==1)u.push(s[o].childNodes[j])}var a=u[n];if(check2(t,a)&&check3(a))a.className=a.css+" "+i}};this.unhighlightCol=function(e,t){var n=e.getElementsByTagName("tr");for(var r=0;r<n.length;r++){var i=new Array;for(j=0;j<n[r].childNodes.length;j++){if(n[r].childNodes[j].nodeType==1)i.push(n[r].childNodes[j])}var s=i[t];if(check3(s))s.className=s.css}};this.highlightRow=function(e,t,n,r){var i=typeof r!="undefined"?"selected":"over";var s=e.getElementsByTagName("tr")[n];for(var o=0;o<s.childNodes.length;o++){var u=s.childNodes[o];if(check2(t,u)&&check3(u))u.className=u.css+" "+i}};this.unhighlightRow=function(e,t){var n=e.getElementsByTagName("tr")[t];for(var r=0;r<n.childNodes.length;r++){var i=n.childNodes[r];if(check3(i))i.className=i.css}};this.unselect=function(e){tr=e.getElementsByTagName("tr");for(var t=0;t<tr.length;t++){for(var n=0;n<tr[t].childNodes.length;n++){var r=tr[t].childNodes[n];if(r.className)r.className=r.className.replace("selected","")}}};this.unselectAll=function(){if(!r){tables=document.getElementsByTagName("table");for(var e=0;e<tables.length;e++){unselect(tables[e])}}};this.check1=function(e,t){return!(t==0&&e.className.indexOf("empty")!=-1)};this.check2=function(e,t){return!(e.tagName=="TH"&&t.tagName=="TH")};this.check3=function(e){return e.className?e.className.indexOf("selected")==-1:true};start()};window.onload=tablecloth